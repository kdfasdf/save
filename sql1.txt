-- 공고게시판
ALTER TABLE NOTICE_POST
	DROP FOREIGN KEY FK_COMPANY_TO_NOTICE_POST; --  기업 -> 공고게시판

-- 자격증
ALTER TABLE LICENSE
	DROP FOREIGN KEY FK_PERSONAL_TO_LICENSE; -- 개인 -> 자격증

-- 학적
ALTER TABLE HAKSA
	DROP FOREIGN KEY FK_PERSONAL_TO_HAKSA; -- 개인 -> 학적

-- 경력
ALTER TABLE CAREER
	DROP FOREIGN KEY FK_PERSONAL_TO_CAREER; -- 개인 -> 경력

-- 진행상황
ALTER TABLE PROGRESS
	DROP FOREIGN KEY FK_COMPANY_TO_PROGRESS; --  기업 -> 


-- 진행상황
ALTER TABLE PROGRESS
	DROP FOREIGN KEY FK_PERSONAL_TO_PROGRESS; -- 개인 -> 진행상황

-- 개인
ALTER TABLE PERSONAL
	DROP PRIMARY KEY; -- 개인 기본키

--  기업
ALTER TABLE COMPANY
	DROP PRIMARY KEY; --  기업 기본키

-- 공고게시판
ALTER TABLE NOTICE_POST
	DROP PRIMARY KEY; -- 공고게시판 기본키

-- 자격증
ALTER TABLE LICENSE
	DROP PRIMARY KEY; -- 자격증 기본키

-- 학적
ALTER TABLE HAKSA
	DROP PRIMARY KEY; -- 학적 기본키

-- 경력
ALTER TABLE CAREER
	DROP PRIMARY KEY; -- 경력 기본키

-- 진행상황
ALTER TABLE PROGRESS
	DROP PRIMARY KEY; -- 진행상황 기본키

-- 개인
DROP TABLE IF EXISTS PERSONAL RESTRICT;

--  기업
DROP TABLE IF EXISTS COMPANY RESTRICT;

-- 공고게시판
DROP TABLE IF EXISTS NOTICE_POST RESTRICT;

-- 자격증
DROP TABLE IF EXISTS LICENSE RESTRICT;

-- 학적
DROP TABLE IF EXISTS HAKSA RESTRICT;

-- 경력
DROP TABLE IF EXISTS CAREER RESTRICT;

-- 진행상황
DROP TABLE IF EXISTS PROGRESS RESTRICT;

-- 개인 
CREATE TABLE PERSONAL (
	P_ID       VARCHAR(20) NOT NULL, -- 개인아이디
	P_PW       VARCHAR(20) NOT NULL, -- 비밀번호
	NAME       NVARCHAR(20) NOT NULL, -- 성명
	P_EMAIL    VARCHAR(50) NOT NULL, -- 이메일
	PHONE      VARCHAR(20) NOT NULL, -- 전화번호
	BIRTH_DATE  INT   NULL,  -- 생년월일
	FILE     VARCHAR(500) NULL, -- 나이
	GENDER     INT  NULL, -- 성별
	REG_DATA   DATE   NULL	-- 서비스 가입 일자
);

-- 개인
ALTER TABLE PERSONAL
	ADD CONSTRAINT PK_PERSONAL -- 개인 기본키
		PRIMARY KEY (
			P_ID -- 개인아이디
		);

--  기업
CREATE TABLE COMPANY (
	CO_ID     VARCHAR(20) NOT NULL, -- 기업아이디
	CO_PW     VARCHAR(20) NOT NULL, -- 기업비밀번호
	COMPANY   NVARCHAR(50) NOT NULL, -- 기업명
	HR        NVARCHAR(50) NOT NULL, -- HR담장자명
	CO_EMAIL  VARCHAR(50) NOT NULL, -- 기업이메일
	CO_NUMBER VARCHAR(20) NOT NULL,  -- 기업전화번호
	CATEGORY_ID  VARCHAR(20) NOT NULL,  -- 기업 업종
	SIZE_ID	  VARCHAR(20) NOT NULL  -- 기업 규모
);

--  기업
ALTER TABLE COMPANY
	ADD CONSTRAINT PK_COMPANY --  기업 기본키
		PRIMARY KEY (
			CO_ID -- 기업아이디
		);

-- 공고게시판
CREATE TABLE NOTICE_POST (
	POST_NO     INT UNSIGNED  NOT NULL, -- 게시물 번호
	CO_ID       VARCHAR(20)   NOT NULL, -- 기업아이디
	POSITION    NVARCHAR(100)  NOT NULL, -- 포지션명
	QUALIFY    NVARCHAR(800)  NOT NULL, -- 자격요건
	JOB         NVARCHAR(1000) NOT NULL, -- 직무설명
	EMPLOY_TYPE NVARCHAR(6)    NOT NULL, -- 고용형태
	REGI_DT    DATETIME    NOT NULL,  -- 진행상태
	CREATED_AT	   TIMESTAMP NOT NULL, -- 생성일자	
	UPDATED_AT  TIMESTAMP NOT NULL, -- 수정일자
	CO_NO BIGINT(20) NOT NULL
);

-- 공고게시판
ALTER TABLE NOTICE_POST
	ADD CONSTRAINT PK_NOTICE_POST -- 공고게시판 기본키
		PRIMARY KEY (
			POST_NO -- 게시물 번호
		);

ALTER TABLE NOTICE_POST
	MODIFY COLUMN POST_NO INT UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE NOTICE_POST
	AUTO_INCREMENT = 1;

-- 자격증
CREATE TABLE LICENSE (
	P_ID    VARCHAR(20) NOT NULL, -- 개인아이디DESC 
	LICENSE VARCHAR(20) NOT NULL  -- 자격증명
);

-- 자격증
ALTER TABLE LICENSE
	ADD CONSTRAINT PK_LICENSE -- 자격증 기본키
		PRIMARY KEY (
			P_ID,    -- 개인아이디
			LICENSE  -- 자격증명
		);

-- 학적
CREATE TABLE HAKSA (
	P_ID            VARCHAR(20) NOT NULL, -- 개인아이디
	SCHOOL_NAME     NVARCHAR(50) NOT NULL, -- 학교명
	MAJOR           NVARCHAR(20) NOT NULL, -- 전공
	ADMISSION_DATE  INT       NOT NULL, -- 입학년도
	GRADUATION_DATE INT       NOT NULL,  -- 졸업년도
	DEGREE  VARCHAR(20)  NULL,	-- 학위
	HAKSANUM INT  AUTO_INCREMENT PRIMARY KEY
	
);

-- 학적
ALTER TABLE HAKSA
	ADD CONSTRAINT PK_HAKSA -- 학적 기본키
		PRIMARY KEY (
			P_ID  
		);

-- 경력
CREATE TABLE CAREER (
	P_ID         VARCHAR(20)   NOT NULL, -- 개인아이디
	P_COMPANY    NVARCHAR(100)  NOT NULL, -- 직장명
	P_DEPARTMENT NVARCHAR(100)  NOT NULL, -- 부서명
	P_DUTY       NVARCHAR(100) NOT NULL  -- 직무
);

-- 경력
ALTER TABLE CAREER
	ADD CONSTRAINT PK_CAREER -- 경력 기본키
		PRIMARY KEY (
			P_ID,      -- 개인아이디
			P_COMPANY  -- 직장명
		);

-- 진행상황
CREATE TABLE PROGRESS (
	PRO_DATE   DATETIME    NOT NULL, -- 진행일자
	CO_ID      VARCHAR(20) NOT NULL, -- 기업아이디
	P_ID       VARCHAR(20) NOT NULL, -- 개인아이디
	PRO_STATUS NVARCHAR(10) NOT NULL  -- 진행상태
);

-- 진행상황
ALTER TABLE PROGRESS
	ADD CONSTRAINT PK_PROGRESS -- 진행상황 기본키
		PRIMARY KEY (
			PRO_DATE, -- 진행일자
			CO_ID,    -- 기업아이디
			P_ID      -- 개인아이디
		);

-- 공고게시판
ALTER TABLE NOTICE_POST
	ADD CONSTRAINT FK_COMPANY_TO_NOTICE_POST --  기업 -> 공고게시판
		FOREIGN KEY (
			CO_ID -- 기업아이디
		)
		REFERENCES COMPANY ( --  기업
			CO_ID -- 기업아이디
		);

-- 자격증
ALTER TABLE LICENSE
	ADD CONSTRAINT FK_PERSONAL_TO_LICENSE -- 개인 -> 자격증
		FOREIGN KEY (
			P_ID -- 개인아이디
		)
		REFERENCES PERSONAL ( -- 개인
			P_ID -- 개인아이디
		);

-- 학적
ALTER TABLE HAKSA
	ADD CONSTRAINT FK_PERSONAL_TO_HAKSA -- 개인 -> 학적
		FOREIGN KEY (
			P_ID -- 개인아이디
		)
		REFERENCES PERSONAL ( -- 개인
			P_ID -- 개인아이디
		);

-- 경력
ALTER TABLE CAREER
	ADD CONSTRAINT FK_PERSONAL_TO_CAREER -- 개인 -> 경력
		FOREIGN KEY (
			P_ID -- 개인아이디
		)
		REFERENCES PERSONAL ( -- 개인
			P_ID -- 개인아이디
		);

-- 진행상황
ALTER TABLE PROGRESS
	ADD CONSTRAINT FK_COMPANY_TO_PROGRESS --  기업 -> 진행상황
		FOREIGN KEY (
			CO_ID -- 기업아이디
		)
		REFERENCES COMPANY ( --  기업
			CO_ID -- 기업아이디
		);

-- 진행상황
ALTER TABLE PROGRESS
	ADD CONSTRAINT FK_PERSONAL_TO_PROGRESS -- 개인 -> 진행상황
		FOREIGN KEY (
			P_ID -- 개인아이디
		)
		REFERENCES PERSONAL ( -- 개인
			P_ID -- 개인아이디
		);









--------------------------
-- 개인
DROP TABLE IF EXISTS PERSONAL RESTRICT;

--  기업
DROP TABLE IF EXISTS COMPANY RESTRICT;

-- 공고게시판
DROP TABLE IF EXISTS NOTICE_POST RESTRICT;

-- 자격증
DROP TABLE IF EXISTS LICENSE RESTRICT;

-- 학적
DROP TABLE IF EXISTS HAKSA RESTRICT;

-- 경력
DROP TABLE IF EXISTS CAREER RESTRICT;

-- 진행상황
DROP TABLE IF EXISTS PROGRESS RESTRICT;